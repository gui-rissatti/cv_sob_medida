openapi: 3.0.0
info:
  title: "CV Sob Medida API"
  description: "API for generating personalized CVs and application materials from job URLs."
  version: "1.0.0"
servers:
  - url: "/api/v1"
paths:
  /extract-job-details:
    post:
      summary: "Extracts job details from a URL"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
      responses:
        '200':
          description: "Successfully extracted job details."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Job'
  /generate-materials:
    post:
      summary: "Generates application materials for a given job"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                job_details:
                  $ref: '#/components/schemas/Job'
                user_cv:
                  type: string
      responses:
        '200':
          description: "Successfully generated materials."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeneratedAssets'
  /generate-complete:
    post:
      summary: "Full flow: extract from URL and generate materials"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                user_cv:
                  type: string
      responses:
        '200':
          description: "Successfully generated all materials."
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeneratedAssets'
  /health:
    get:
      summary: "Health check endpoint"
      responses:
        '200':
          description: "API is healthy."
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"

components:
  schemas:
    Job:
      type: object
      properties:
        id:
          type: string
        url:
          type: string
          format: uri
        title:
          type: string
        company:
          type: string
        description:
          type: string
        skills:
          type: array
          items:
            type: string
        createdAt:
          type: string
          format: date-time
    GeneratedAssets:
      type: object
      properties:
        jobId:
          type: string
        cv:
          type: string
        coverLetter:
          type: string
        networking:
          type: string
        insights:
          type: string
        matchScore:
          type: number
        generatedAt:
          type: string
          format: date-time
